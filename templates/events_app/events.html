{% extends 'base.html' %}
{% load static %}
{% block content %}
<div class="row">
  <!-- Sidebar -->
  <aside class="col-md-3 mb-4">
    <div class="list-group">
        <a href="{% url 'events_app:create_event' %}" class="list-group-item list-group-item-action">
            + Add Event
          </a>
      <a href="#" class="list-group-item list-group-item-action">Private</a>
      <a href="#" class="list-group-item list-group-item-action">Public</a>
      <a href="{% url 'events_app:my_events' %}" class="list-group-item list-group-item-action">My Events</a>
    </div>
  </aside>

  <!-- Main Content Area -->
  <section class="col-md-9">
    <!-- Search Bar -->
    <form method="GET" action="{% url 'events_app:search_events' %}" class="mb-3">
      <div class="input-group">
        <input type="text" name="q" class="form-control" placeholder="Search events...">
        <button class="btn btn-outline-secondary" type="submit">Search</button>
      </div>
    </form>

    <!-- Events List -->
    <div class="list-group">
      {% for event in events %}
        <div class="list-group-item">
          <div class="row align-items-center">
            <!-- Host Info -->
            <div class="col-md-2 text-center">
              <img src="https://via.placeholder.com/80" alt="{{ event.host.username }}" class="img-fluid rounded-circle mb-2">
              <p class="mb-0">{{ event.host.username }}</p>
            </div>
            <!-- Event Details -->
            <div class="col-md-7">
              <h5>{{ event.title }}</h5>
              <p class="mb-1">{{ event.description|truncatewords:15 }}</p>
              <small>
                {{ event.start_time|date:"M d, Y H:i" }} - 
                {{ event.end_time|date:"H:i" }}
              </small>
            </div>
            <!-- Action Button -->
            <div class="col-md-3 text-center">
                {% if user in event.participants.all %}
                <a href="{% url 'events_app:leave_event' event.id %}" class="btn btn-warning">
                  Leave Event
                </a>
              {% else %}
                <a href="{% url 'events_app:join_event' event.id %}" class="btn btn-primary">
                  Join Event
                </a>
              {% endif %}
            </div>
          </div>
        </div>
      {% empty %}
        <div class="list-group-item">
          <p>No events found.</p>
        </div>
      {% endfor %}
    </div>
  </section>
</div>
{% endblock %}
