{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>User Profile</title>
    <link rel="stylesheet" href="{% static 'css/profile.css' %}">
</head>
<body>

<!-- TOP NAV BAR (same size as other pages) -->
<nav class="navbar">
    <div class="nav-left">
        <a href="#">CONTACT US</a> 
    </div>
    <div class="nav-center">
        <h1>NAVIGATION BAR</h1>
    </div>
    <div class="nav-right">
        <a href="{% url 'events' %}">EVENTS</a>
        <a href="{% url 'home' %}">HOME</a>
    </div>
</nav>

<!-- LARGE BACKGROUND / PROFILE HEADER -->
<section class="profile-header">
    <!-- Background image (inline style for demo, or move to CSS) -->
    <div class="bg-picture" style="background-color: grey;">
    </div>
    

    <!-- Circular container for the profile image -->
    <div class="profile-image">
        {% if user.profile_picture %}
            <!-- If the user uploaded a pic, display it -->
            <img src="{{ user.profile_picture.url }}" alt="Profile Pic">
        {% else %}
            <img src="{% static 'images/blank-profile-picture.jpg' %}" alt="Default Pic">
        {% endif %}
    </div>

    <!-- Overlapping name box -->
    <div class="user-name-box">
        <p>{{ user.username }}{% if user.age %} ({{ user.age }}){% endif %}</p>
    </div>
</section>

<!-- PROFILE DESCRIPTION BAR -->
<section class="profile-description-bar">
    <h2>
        {% if user.bio %}
            {{ user.bio }}
        {% else %}
            No bio.
        {% endif %}
    </h2>
</section>

<!-- MAIN CONTENT: 3 COLUMNS -->
<div class="profile-content">
    <!-- LEFT COLUMN: Age, Gyms, Sports Club, Buddy List -->
    <div class="left-col">
        <h3>AGE</h3>
        <p>{{ user.age|default:"Not specified" }}</p>
        <h3>GYMS</h3>
        <p>
            {% for gym in user.gym.all %}
                {{ gym.name }}{% if not forloop.last %}, {% endif %}
            {% endfor %}
        </p>
        <h3>SPORTS CLUB</h3>
        <p>
            {% for club in user.clubs.all %}
                {{ club.name }}{% if not forloop.last %}, {% endif %}
            {% empty %}
                None selected
            {% endfor %}
        </p>
        <h3>BUDDY LIST</h3>
        <p>
            {% for buddy in user.buddies.all %}
                {{ buddy.username }}{% if not forloop.last %}, {% endif %}
            {% empty %}
                No buddies yet
            {% endfor %}
        </p>
    </div>

    <!-- CENTER COLUMN: Create Event / My Events -->
    <div class="center-col">
        <!-- Tabs Row -->
        <div class="tabs-row">
            <button class="tab-btn active" data-tab="create-event">Create Event</button>
            <button class="tab-btn" data-tab="my-events">My Events</button>
        </div>

        <!-- Tab Content Wrapper -->
        <div class="tab-content-area">
            <!-- CREATE EVENT CONTENT -->
            <div class="tab-content active" id="create-event">
                <h2>Create Event</h2>
                <p>Form or fields for creating an event go here.</p>
                <!-- Example form (replace with real Django form) -->
                <form method="POST">
                    {% csrf_token %}
                    <!-- your event fields, e.g. title, date, location... -->
                    <button type="submit" class="create-event-btn">Submit Event</button>
                </form>
            </div>

            <!-- MY EVENTS CONTENT -->
            <div class="tab-content" id="my-events">
                <h2>My Events</h2>
                
                <div class="events-section">
                    <h3>Hosted Events</h3>
                    {% for event in hosted_events %}
                        <div class="event-item">
                            <strong>{{ event.title }}</strong><br>
                            <span>{{ event.start_time|date:"M d, Y H:i" }}</span><br>
                            <span>{{ event.location }}</span>
                        </div>
                    {% empty %}
                        <div class="event-item">No hosted events found.</div>
                    {% endfor %}
                </div>
                
                <div class="events-section">
                    <h3>Participated Events</h3>
                    {% for event in participated_events %}
                        <div class="event-item">
                            <strong>{{ event.title }}</strong><br>
                            <span>{{ event.start_time|date:"M d, Y H:i" }}</span><br>
                            <span>{{ event.location }}</span>
                        </div>
                    {% empty %}
                        <div class="event-item">No participated events found.</div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

    <!-- RIGHT COLUMN: Settings + Upload New Profile Pic -->
    <div class="right-col">
        <h2>Edit Profile</h2>

        <!-- Separate link to edit profile -->
        <a href="{% url 'edit_profile' %}">Edit Profile</a>

    </div>
</div>

<!-- Script for Tab Switching (same as before) -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const tabButtons = document.querySelectorAll('.tab-btn');
        const tabContents = document.querySelectorAll('.tab-content');
        tabButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                tabButtons.forEach(b => b.classList.remove('active'));
                tabContents.forEach(tc => tc.classList.remove('active'));
                btn.classList.add('active');
                const targetId = btn.getAttribute('data-tab');
                document.getElementById(targetId).classList.add('active');
            });
        });
    });
</script>

</body>
</html>